<!doctype html>
<html lang="pt-br">

<head>
    <meta charset="utf-8" />
    <title>Carta de Reclama√ß√£o de Compra Online | CartasApp</title>
    <meta name="description"
        content="Gere uma carta de reclama√ß√£o para compras online (atraso, defeito, arrependimento). Modelo pronto." />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <script src="/theme.js"></script>
    <link rel="stylesheet" href="/style.css" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-1021062139"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'AW-1021062139');
        gtag('config', 'G-D40QPP9KNP');
    </script>
    <script src="/gtag.js"></script>
    <script
        type="text/javascript">(function (c, l, a, r, i, t, y) { c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) }; t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i; y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y); })(window, document, "clarity", "script", "u4x90t35gk");</script>
    <link rel="canonical" href="https://www.cartasapp.com.br/ecommerce.html" />
</head>

<body>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <a href="/" class="logo">CartasApp</a>
                <div class="nav-actions"><button class="btn-theme" onclick="toggleTheme()">üåô</button><a
                        href="https://wa.me/5547991323024" class="btn btn-secondary btn-sm" target="_blank">WhatsApp</a>
                </div>
            </div>
        </div>
    </nav>
    <div class="container" style="padding-top: 40px;">
        <div class="card" style="max-width: 800px; margin: 0 auto;">
            <div style="text-align: center; margin-bottom: 24px;">
                <div class="hero-badge">üõí E-commerce</div>
                <h1 style="font-size: 48px; margin-top: 12px;">Reclama√ß√£o de Compra Online</h1>
                <p class="hero-subtitle" style="font-size: 18px;">Preencha os dados e gere a carta em .DOC.</p>
            </div>
            <div id="formArea">
                <h2 class="section-title" style="font-size: 24px; margin-bottom: 24px;">Consumidor</h2>
                <label class="label">Nome completo</label><input class="input" id="nome"
                    placeholder="Ex.: Diego Rosa" />
                <label class="label">CPF</label><input class="input" id="cpf" placeholder="000.000.000-00"
                    inputmode="numeric" maxlength="14" />
                <div id="err_cpf" class="small" style="display:none;color:#fca5a5">CPF inv√°lido.</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px; margin-top: 20px;">
                    <div><label class="label">E-mail</label><input class="input" id="email"
                            placeholder="seu@email.com" /></div>
                    <div><label class="label">Telefone</label><input class="input" id="telefone"
                            placeholder="(00) 00000-0000" /></div>
                </div>
                <h2 class="section-title" style="font-size: 24px; margin: 32px 0 24px;">Pedido</h2>
                <label class="label">Loja/Marketplace</label><input class="input" id="loja" placeholder="Ex.: Amazon" />
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px; margin-top: 20px;">
                    <div><label class="label">N¬∫ do pedido</label><input class="input" id="pedido"
                            placeholder="Ex.: 123456" /></div>
                    <div><label class="label">Valor (opcional)</label><input class="input" id="valor"
                            placeholder="Ex.: R$ 249,90" /></div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px; margin-top: 20px;">
                    <div><label class="label">Data da compra</label><input class="input" id="data_compra"
                            placeholder="DD/MM/AAAA" inputmode="numeric" maxlength="10" />
                        <div id="err_data_compra" class="small" style="display:none;color:#fca5a5">Data inv√°lida.</div>
                    </div>
                    <div><label class="label">Previs√£o entrega</label><input class="input" id="previsao_entrega"
                            placeholder="DD/MM/AAAA" inputmode="numeric" maxlength="10" /></div>
                </div>
                <h2 class="section-title" style="font-size: 24px; margin: 32px 0 24px;">Motivo</h2>
                <label class="label">Selecione o motivo</label><select class="input" id="motivo">
                    <option value="nao_entregue">Produto n√£o entregue</option>
                    <option value="atraso">Atraso na entrega</option>
                    <option value="produto_errado">Produto errado</option>
                    <option value="produto_defeituoso">Produto com defeito</option>
                    <option value="arrependimento">Direito de arrependimento</option>
                </select>
                <label class="label">Itens / resumo</label><textarea class="input" id="itens" rows="3"
                    placeholder="Ex.: 1x Fone XYZ..."></textarea>
                <label class="label">Cidade/UF</label><input class="input" id="cidade_uf"
                    placeholder="Ex.: Blumenau/SC" />
                <label class="label">Observa√ß√µes (opcional)</label><textarea class="input" id="observacoes" rows="3"
                    placeholder="Ex.: Informa√ß√µes adicionais"></textarea>

                <div style="margin-top:20px;">
                    <div id="previewBtnArea">
                        <button class="btn btn-secondary" id="btnPreview" style="width:100%">Gerar pr√©via</button>
                    </div>
                    <div id="paySection"
                        style="display:none; margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border);">
                        <div class="price-badge" style="margin-bottom: 20px;">
                            Oferta hoje: <span class="price-old">de R$ 29,90</span> <span class="price-new">por R$
                                9,90</span>
                            <span class="timer-text">‚ö° O pre√ßo pode voltar ao normal em breve</span>
                        </div>
                        <button class="btn btn-primary" id="btnPagar" style="width: 100%;">Gerar documento completo (R$
                            9,90)</button>
                    </div>
                </div>
                <div class="guarantee-badge"><span class="guarantee-icon">üîí</span>
                    <div><strong>Garantia Total:</strong> Receba seu documento pronto ou devolvemos seu dinheiro.</div>
                </div>
            </div>
            <div id="previewWrap"
                style="display:none; margin-top:32px; padding-top:32px; border-top:1px solid var(--border);">
                <h2 class="section-title" style="font-size: 24px; margin-bottom: 20px;">Pr√©via do documento</h2>
                <div
                    style="background:var(--bg-secondary);border:1px solid var(--border);border-radius:12px;padding:24px;">
                    <div id="previewBox"
                        style="white-space:pre-wrap;font-family:monospace;font-size:14px;line-height:1.8;color:var(--text-secondary);">
                    </div>
                </div>
                <p class="small" style="margin-top:12px;color:var(--text-muted);">Pr√©via parcial.</p>
            </div>
        </div>
    </div>
    <footer class="footer">
    <div class="container">
        <div class="footer-content">
            <p>
                Este site n√£o presta aconselhamento jur√≠dico. Leia os
                <a href="/termos.html" class="footer-link">Termos de Uso</a>,
                <a href="/privacidade.html" class="footer-link">Pol√≠tica de Privacidade</a>,
                conhe√ßa mais em
                <a href="/sobre.html" class="footer-link">Sobre o CartasApp</a>
                e visite nossa
                <a href="/blog.html" class="footer-link">Central de Ajuda</a>.
            </p>
        </div>
    </div>
</footer>
    <a href="https://wa.me/5547991323024?text=Ol%C3%A1!%20Preciso%20de%20ajuda%20no%20CartasApp." class="whatsapp-float"
        target="_blank" aria-label="Falar no WhatsApp"><svg viewBox="0 0 24 24" class="whatsapp-icon">
            <path
                d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
        </svg></a>
    <script src="/utm.js"></script>
    <script>
        function maskCPF(v) { v = (v || '').replace(/\D/g, '').slice(0, 11); v = v.replace(/(\d{3})(\d)/, '$1.$2'); v = v.replace(/(\d{3})(\d)/, '$1.$2'); v = v.replace(/(\d{3})(\d{1,2})$/, '$1-$2'); return v; } function isValidCPF(cpf) { var s = (cpf || '').replace(/\D/g, ''); if (s.length !== 11) return false; if (/^(\d)\1{10}$/.test(s)) return false; var i, sum = 0, rest; for (i = 1; i <= 9; i++)sum += parseInt(s.substring(i - 1, i)) * (11 - i); rest = (sum * 10) % 11; if (rest === 10 || rest === 11) rest = 0; if (rest !== parseInt(s.substring(9, 10))) return false; sum = 0; for (i = 1; i <= 10; i++)sum += parseInt(s.substring(i - 1, i)) * (12 - i); rest = (sum * 10) % 11; if (rest === 10 || rest === 11) rest = 0; if (rest !== parseInt(s.substring(10, 11))) return false; return true; } function maskDate(v) { v = (v || '').replace(/\D/g, '').slice(0, 8); if (v.length >= 5) v = v.replace(/(\d{2})(\d{2})(\d{1,4})/, '$1/$2/$3'); else if (v.length >= 3) v = v.replace(/(\d{2})(\d{1,2})/, '$1/$2'); return v; } function isValidDateBR(s) { if (!/^\d{2}\/\d{2}\/\d{4}$/.test(s || '')) return false; var d = parseInt(s.substr(0, 2), 10), m = parseInt(s.substr(3, 2), 10), y = parseInt(s.substr(6, 4), 10); if (y < 1900 || y > 2100 || m < 1 || m > 12 || d < 1 || d > 31) return false; var md = [31, (y % 4 === 0 && y % 100 !== 0) || y % 400 === 0 ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; if (d > md[m - 1]) return false; return true; }
        var ids = ['nome', 'cpf', 'email', 'telefone', 'loja', 'pedido', 'valor', 'data_compra', 'previsao_entrega', 'motivo', 'forma_pagto', 'itens', 'cidade_uf', 'observacoes']; var SAVE_KEY = 'ecomm_form_v1'; function saveForm() { var o = {}; for (var i = 0; i < ids.length; i++) { var el = document.getElementById(ids[i]); if (el) o[ids[i]] = el.value; } localStorage.setItem(SAVE_KEY, JSON.stringify(o)); } function loadForm() { try { var o = JSON.parse(localStorage.getItem(SAVE_KEY) || '{}'); for (var k in o) { if (document.getElementById(k)) document.getElementById(k).value = o[k]; } } catch (e) { } } function attachAutosave() { for (var i = 0; i < ids.length; i++) { var el = document.getElementById(ids[i]); if (el) { el.addEventListener('input', saveForm); el.addEventListener('change', saveForm); } } } document.getElementById('cpf').addEventListener('input', function () { this.value = maskCPF(this.value); }); var dateIds = ['data_compra', 'previsao_entrega']; for (var i = 0; i < dateIds.length; i++) { var e = document.getElementById(dateIds[i]); if (e) { e.addEventListener('input', function (ev) { ev.target.value = maskDate(ev.target.value); }); } }
        function getPayload() { var cpfEl = document.getElementById('cpf'); cpfEl.value = maskCPF(cpfEl.value); return { tipo: 'consumo', slug: 'carta-ecommerce', nome: document.getElementById('nome').value.trim(), cpf: document.getElementById('cpf').value.trim(), email: document.getElementById('email').value.trim(), telefone: document.getElementById('telefone').value.trim(), loja: document.getElementById('loja').value.trim(), pedido: document.getElementById('pedido').value.trim(), valor: document.getElementById('valor').value.trim(), data_compra: document.getElementById('data_compra').value.trim(), previsao_entrega: document.getElementById('previsao_entrega').value.trim(), motivo: document.getElementById('motivo').value, forma_pagto: document.getElementById('forma_pagto').value, itens: document.getElementById('itens').value.trim(), cidade_uf: document.getElementById('cidade_uf').value.trim(), observacoes: document.getElementById('observacoes').value.trim(), utm: (window.LMUTM ? LMUTM.get() : {}) }; } function validateAll(p) { var ok = true; var cpfOk = isValidCPF(p.cpf); document.getElementById('err_cpf').style.display = cpfOk ? 'none' : 'block'; if (!cpfOk) ok = false; if (!p.nome || !p.loja || !p.pedido || !p.cidade_uf) ok = false; if (!isValidDateBR(p.data_compra)) { document.getElementById('err_data_compra').style.display = 'block'; ok = false; } else { document.getElementById('err_data_compra').style.display = 'none'; } return ok; }

        var btnPreview = document.getElementById('btnPreview'); var btnPagar = document.getElementById('btnPagar'); var previewWrap = document.getElementById('previewWrap'); var previewBox = document.getElementById('previewBox');
        var paySection = document.getElementById('paySection');

        function checkCooldown() { var last = localStorage.getItem('last_preview_ts'); if (last && (Date.now() - parseInt(last)) < 30000) { alert('Aguarde 30s para gerar novamente.'); return false; } return true; }

        loadForm(); attachAutosave(); (function () { var u = new URL(location.href); var pref = u.searchParams.get('pref'); if (pref === 'arrependimento') document.getElementById('motivo').value = 'arrependimento'; if (pref === 'nao_entregue') document.getElementById('motivo').value = 'nao_entregue'; if (pref === 'atraso') document.getElementById('motivo').value = 'atraso'; })();

        // PR√âVIA (ECOMMERCE)
        btnPreview.addEventListener('click', async function () {
            if (!checkCooldown()) return;

            btnPreview.disabled = true;
            btnPreview.style.opacity = '0.5';
            btnPreview.style.cursor = 'not-allowed';
            btnPreview.textContent = '‚è≥ Gerando... (aguarde 30s)';

            async function tentarGerar(tentativa) {
                var vaiTentarDeNovo = false;
                try {
                    var p = getPayload();
                    if (!validateAll(p)) {
                        alert('Verifique os campos obrigat√≥rios.');
                        btnPreview.disabled = false;
                        btnPreview.style.opacity = '1';
                        btnPreview.style.cursor = 'pointer';
                        btnPreview.textContent = 'Gerar pr√©via';
                        return;
                    }

                    saveForm();

                    var r = await fetch('/.netlify/functions/generate-doc', {
                        method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ payload: p, preview: true })
                    });

                    if (r.status === 503 && tentativa === 1) {
                        btnPreview.textContent = '‚Üª Reconectando...';
                        vaiTentarDeNovo = true;
                        await new Promise(res => setTimeout(res, 2000));
                        return tentarGerar(2);
                    }

                    if (!r.ok) throw new Error('Falha');

                    var d = await r.json();
                    var out = d.output || d;
                    var pr = out.corpo_paragrafos || [];
                    var parcial = pr.slice(0, 2).join('\n\n') + '\n\n[...]';

                    previewBox.textContent = (out.saudacao || '') + '\n\n' + parcial;
                    previewWrap.style.display = 'block';

                    // PROMO√á√ÉO
                    paySection.style.display = 'block';
                    document.getElementById('previewBtnArea').style.display = 'none';

                    if (typeof gtag === 'function') {
                        gtag('event', 'generate_lead', { 'send_to': 'AW-1021062139/Ri4bCICS88IbEPvX8OYD', 'event_category': 'engagement', 'event_label': 'ecommerce', 'value': 2.00, 'currency': 'BRL' });
                    }

                    localStorage.setItem('pendingPayload', JSON.stringify(p));
                    localStorage.setItem('last_preview_ts', Date.now());
                    btnPagar.disabled = false;

                } catch (e) {
                    if (!vaiTentarDeNovo) {
                        if (e.message !== 'Inv√°lido') alert('Erro: ' + e.message);
                    }
                } finally {
                    if (!vaiTentarDeNovo && paySection.style.display === 'none') {
                        setTimeout(() => {
                            btnPreview.disabled = false;
                            btnPreview.style.opacity = '1';
                            btnPreview.style.cursor = 'pointer';
                            btnPreview.textContent = 'Gerar pr√©via';
                        }, 30000);
                    }
                }
            }
            tentarGerar(1);
        });

        // PAGAR SEM CAPTCHA
        btnPagar.addEventListener('click', async function () {
            btnPagar.disabled = true; btnPagar.textContent = 'Preparando...';
            try {
                var p = getPayload(); if (!validateAll(p)) { alert('Verifique os campos.'); throw new Error('Inv√°lido'); }
                var r = await fetch('/.netlify/functions/mp-checkout', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ slug: 'carta-ecommerce', payload: p, utm: (window.LMUTM ? LMUTM.get() : {}) }) });
                var data = await r.json(); if (!r.ok) throw new Error(data.error);
                showPaymentModal(data.init_point, data.order_id, 'carta-ecommerce');
            } catch (e) { if (e.message !== 'Inv√°lido') alert('Erro: ' + e.message); btnPagar.disabled = false; btnPagar.textContent = 'Gerar documento completo (R$ 9,90)'; }
        });

        function showPaymentModal(initPoint, orderId, slug) {
            var isLight = (document.documentElement.getAttribute('data-theme') === 'light');
            var cardBG = isLight ? '#ffffff' : '#111827'; var cardText = isLight ? '#0f172a' : '#e6eefb';
            var overlay = document.createElement('div');
            overlay.style = 'position:fixed;inset:0;background:rgba(2,6,23,.85);backdrop-filter:blur(4px);z-index:9999;display:flex;align-items:center;justify-content:center';
            overlay.innerHTML = '<div style="background:' + cardBG + ';color:' + cardText + ';border:1px solid var(--border);border-radius:16px;max-width:400px;width:90%;padding:24px;box-shadow:0 20px 50px rgba(0,0,0,.4);text-align:center;"><div style="font-size:40px;margin-bottom:16px;">üí∏</div><h3 style="margin:0 0 12px;font-size:20px;">Quase l√°!</h3><p style="margin:0 0 20px;line-height:1.5;color:var(--text-secondary);">Clique abaixo para finalizar.</p><div style="display:flex;flex-direction:column;gap:12px;"><button id="lm-goPay" class="btn btn-primary" style="width:100%;padding:14px;font-size:16px;justify-content:center;">Ir para Pagamento (Pix/Cart√£o)</button><button id="lm-close" class="btn btn-outline" style="width:100%;justify-content:center;border:none;">Fechar e corrigir</button></div><p id="lm-statusPay" class="small" style="margin-top:16px;font-size:12px;opacity:0.8;"></p></div>';
            document.body.appendChild(overlay);
            document.getElementById('lm-close').onclick = function () { overlay.remove(); var btn = document.getElementById('btnPagar'); if (btn) { btn.disabled = false; btn.textContent = 'Gerar documento completo (R$ 9,90)'; } };
            async function docReady() { try { var r = await fetch('/.netlify/functions/generate-doc', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ payload: { order_id: orderId }, preview: false }) }); if (!r.ok) return false; var j = await r.json(); return !!(j && j.output); } catch (e) { return false; } }
            document.getElementById('lm-goPay').onclick = function () { window.open(initPoint, '_blank', 'noopener'); var btn = this; btn.textContent = 'Verificando...'; var iv = setInterval(async function () { try { if (await docReady()) { clearInterval(iv); location.href = '/success.html?o=' + encodeURIComponent(orderId) + '&slug=' + encodeURIComponent(slug) + '&s=success'; return; } var rr = await fetch('/.netlify/functions/order-status?o=' + encodeURIComponent(orderId)); var jj = rr.ok ? await rr.json() : null; if (jj && jj.status === 'paid') { clearInterval(iv); location.href = '/success.html?o=' + encodeURIComponent(orderId) + '&slug=' + encodeURIComponent(slug) + '&s=success'; } } catch (e) { } }, 3000); };
        }
    </script>
    <script>
        (function () {
            // Verifica se a URL tem ?modo=admin
            const params = new URLSearchParams(window.location.search);
            if (params.get('modo') === 'admin') {
                // Procura o bot√£o de pagar (funciona mesmo se o ID for diferente)
                const btnPagar = document.querySelector('[id*="Pagar"], [id*="pagar"]') || document.getElementById('btnPagar');
                if (!btnPagar) return; // Se n√£o achar bot√£o, n√£o faz nada

                const btnArea = btnPagar.parentElement;

                // Cria o bot√£o Admin
                const btnAdmin = document.createElement('button');
                btnAdmin.className = 'btn';
                btnAdmin.style.backgroundColor = '#8b5cf6';
                btnAdmin.style.color = 'white';
                btnAdmin.style.border = 'none';
                btnAdmin.innerText = 'üëë Gerar Admin';

                btnAdmin.onclick = async function () {
                    const senha = prompt("Digite a senha de Admin:");
                    if (!senha) return;

                    btnAdmin.innerText = 'Gerando...';
                    btnAdmin.disabled = true;

                    try {
                        // Usa a fun√ß√£o getPayload() que j√° existe na p√°gina
                        var p = getPayload();
                        p.admin_key = senha;

                        var r = await fetch('/.netlify/functions/generate-doc', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ payload: p, preview: false })
                        });

                        if (!r.ok) throw new Error('Senha errada ou erro no servidor');

                        var data = await r.json();

                        if (data.output) {
                            // üî• Monta o texto completo do documento
                            let fullText = '';
                            if (data.output.saudacao) fullText += data.output.saudacao + '\n\n';

                            if (Array.isArray(data.output.corpo_paragrafos)) {
                                fullText += data.output.corpo_paragrafos.join('\n\n');
                            } else {
                                fullText += String(data.output.corpo_paragrafos);
                            }

                            if (data.output.fechamento) fullText += '\n\n' + data.output.fechamento;

                            // Exibe no preview (funciona em qualquer p√°gina)
                            const previewBox = document.getElementById('previewBox');
                            const previewWrap = document.getElementById('previewWrap');

                            if (previewBox && previewWrap) {
                                previewBox.textContent = fullText;
                                previewBox.style.whiteSpace = 'pre-wrap';
                                previewWrap.style.display = 'block';

                                // Remove bot√µes antigos se existirem
                                const oldCopyBtn = document.getElementById('admin-copy-btn');
                                if (oldCopyBtn) oldCopyBtn.remove();

                                // Adiciona bot√£o de copiar
                                const copyBtn = document.createElement('button');
                                copyBtn.id = 'admin-copy-btn';
                                copyBtn.className = 'btn btn-primary';
                                copyBtn.style.marginTop = '16px';
                                copyBtn.innerText = 'üìã Copiar Documento';
                                copyBtn.onclick = async function () {
                                    await navigator.clipboard.writeText(fullText);
                                    copyBtn.innerText = '‚úÖ Copiado!';
                                    setTimeout(() => { copyBtn.innerText = 'üìã Copiar Documento'; }, 2000);
                                };
                                previewWrap.appendChild(copyBtn);

                                // Rola a p√°gina para o preview
                                previewWrap.scrollIntoView({ behavior: 'smooth', block: 'start' });

                                alert("‚úÖ Documento Admin Gerado!\n\nRole para baixo para copiar.");
                            } else {
                                // Fallback: mostra em alert se n√£o tiver preview
                                alert("‚úÖ Documento Gerado!\n\n" + fullText.substring(0, 500) + "...\n\n(Copie do console)");
                                console.log(fullText);
                            }
                        }

                    } catch (e) {
                        alert('‚ùå Erro: ' + e.message);
                    } finally {
                        btnAdmin.innerText = 'üëë Gerar Admin';
                        btnAdmin.disabled = false;
                    }
                };

                btnArea.appendChild(btnAdmin);
            }
        })();
    </script>
</body>

</html>
