<!doctype html>
<html lang="pt-br">

<head>
    <meta charset="utf-8" />
    <title>Carta de Direito de Arrependimento (Compra Online) | CartasApp</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" href="/logo.png" />
    <link rel="apple-touch-icon" href="/logo.png" />
    <meta name="description"
        content="Gere uma carta para exercer o direito de arrependimento em compras online (7 dias, art. 49 do CDC). Preencha os dados, pague R$ 9,90 e baixe em PDF e Word." />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <script src="/theme.js"></script>
    <link rel="stylesheet" href="/style.css" />

    <link rel="canonical" href="https://www.cartasapp.com.br/arrependimento-compra-online.html" />

    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-1021062139"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'AW-1021062139');
        gtag('config', 'G-D40QPP9KNP');
    </script>
    <script src="/gtag.js"></script>
    <script
        type="text/javascript">(function (c, l, a, r, i, t, y) { c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) }; t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i; y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y); })(window, document, "clarity", "script", "u4x90t35gk");</script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org/",
      "@type": "Product",
      "name": "Carta de Direito de Arrependimento (Compra Online)",
      "image": "https://www.cartasapp.com.br/logo.png",
      "description": "Gere uma carta formal para exercer o direito de arrependimento em compras pela internet, telefone ou cat√°logo (art. 49 do CDC).",
      "brand": { "@type": "Brand", "name": "CartasApp" },
      "offers": {
        "@type": "Offer",
        "url": "https://www.cartasapp.com.br/arrependimento-compra-online.html",
        "priceCurrency": "BRL",
        "price": "9.90",
        "priceValidUntil": "2026-12-31",
        "availability": "https://schema.org/InStock",
        "category": "LegalService"
      }
    }
    </script>
</head>

<body>
    <nav class="navbar" style="box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
        <div class="container">
            <div class="navbar-content" style="display: flex; justify-content: space-between; align-items: center; height: 60px;">
                
                <a href="/" class="logo" style="display: flex; align-items: center; gap: 10px; text-decoration: none;">
                    <img src="/logo.png" alt="CartasApp" style="height: 42px; width: auto;">
                    <span style="font-weight: 800; font-size: 20px; color: var(--text-primary); letter-spacing: -0.5px;">CartasApp</span>
                </a>
                <div class="nav-actions">
                    <button class="btn-theme" onclick="toggleTheme()" aria-label="Alternar tema" 
                        style="background: transparent; border: 1px solid var(--border); color: var(--text-primary); width: 38px; height: 38px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s;">
                        üåô
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <section class="hero" style="padding: 60px 0 40px;">
        <div class="container">
            <div class="hero-content">
                <div class="hero-badge">üõí Compra online em at√© 7 dias?</div>
                <h1 style="font-size: 42px; line-height: 1.2;">
                    Carta de direito de arrependimento (compra pela internet)
                </h1>
                <p class="hero-subtitle" style="font-size: 18px; margin-top: 16px;">
                    Use seu <strong>direito de arrependimento</strong> em at√© 7 dias (art. 49 do CDC). Gere uma carta
                    formal para cancelar a compra online e exigir <strong>reembolso integral</strong>.
                </p>

                <div class="hero-actions" style="margin-top: 24px;">
                    <a href="#formArea" class="btn btn-primary">
                        Come√ßar agora (leva menos de 5 minutos)
                    </a>
                </div>

                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 16px; flex-wrap: wrap;">
                    <span
                        style="background: rgba(16, 185, 129, 0.1); color: #10b981; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">‚öñÔ∏è
                        Art. 49 do C√≥digo de Defesa do Consumidor</span>
                    <span
                        style="background: rgba(59, 130, 246, 0.1); color: #3b82f6; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">üì¶
                        Compras pela internet, telefone ou cat√°logo</span>
                    <span
                        style="background: rgba(234, 179, 8, 0.12); color: #eab308; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">üí∞
                        Pagamento √∫nico, sem mensalidade</span>
                </div>
            </div>
        </div>
    </section>

    <section class="section" style="padding-top: 0;">
        <div class="container">
            <div style="max-width: 800px; margin: 0 auto;">
                <div class="card">
                    <div class="small"
                        style="margin-bottom: 16px; padding: 12px 14px; border-radius: 10px; background: var(--card-hover); border: 1px solid var(--border);">
                        <strong>Quando voc√™ pode usar esta carta?</strong><br>
                        ‚Ä¢ Compras feitas <strong>pela internet, telefone, aplicativos ou cat√°logo</strong>.<br>
                        ‚Ä¢ Ainda dentro do prazo de <strong>7 dias</strong> contados da entrega ou contrata√ß√£o.<br>
                        ‚Ä¢ Mesmo que o produto n√£o tenha defeito (arrependimento sem justificativa).
                    </div>

                    <div class="small" style="margin-bottom: 24px;">
                        A carta serve para <strong>formalizar o cancelamento</strong> e o pedido de reembolso integral,
                        o que ajuda em poss√≠veis reclama√ß√µes no Procon, plataformas de consumo ou a√ß√£o judicial.
                    </div>

                    <div class="small"
                        style="margin-bottom: 24px; padding: 12px 14px; border-radius: 10px; background: var(--bg-secondary); border: 1px solid var(--border);">
                        <strong>Por R$ 9,90 (pagamento √∫nico)</strong>, voc√™ recebe:<br>
                        ‚Ä¢ Carta personalizada, com seus dados e dados da compra.<br>
                        ‚Ä¢ Arquivos em PDF e Word para enviar por e-mail ou imprimir.<br>
                        ‚Ä¢ Suporte por WhatsApp em caso de d√∫vidas sobre o uso do documento.
                    </div>

                    <div id="formArea">
                        <div class="step-indicator">
                            <div class="step-item" data-step="1">1. Seus dados</div>
                            <div class="step-item" data-step="2">2. Dados da compra</div>
                            <div class="step-item" data-step="3">3. Motivo e contato</div>
                        </div>

                        <!-- PASSO 1 -->
                        <div class="form-step" data-step="1" id="a-step-1">
                            <h2 class="section-title" style="font-size: 24px; margin-bottom: 16px;">Seus dados</h2>

                            <label class="label">Nome completo <span class="required-star">*</span></label>
                            <input class="input" id="a_nome" placeholder="Ex.: Maria Souza" />

                            <label class="label">CPF <span class="required-star">*</span></label>
                            <input class="input" id="a_cpf" placeholder="000.000.000-00" inputmode="numeric"
                                maxlength="14" />
                            <div id="a_err_cpf" class="small" style="display:none;color:#fca5a5;margin-top:4px;">CPF
                                inv√°lido.</div>

                            <label class="label">Endere√ßo completo (rua, n¬∫, bairro)
                                <span class="required-star">*</span>
                            </label>
                            <input class="input" id="a_endereco" placeholder="Ex.: Rua X, 123, Bairro Y" />

                            <label class="label">Cidade/UF <span class="required-star">*</span></label>
                            <input class="input" id="a_cidade_uf" placeholder="Ex.: Recife/PE" />

                            <div class="form-navigation">
                                <span class="small" style="align-self:center;color:var(--text-muted);">
                                    Campos marcados com <span class="required-star">*</span> s√£o obrigat√≥rios.
                                </span>
                                <button type="button" class="btn btn-primary" id="a_nextStep1">
                                    Pr√≥ximo passo
                                </button>
                            </div>
                        </div>

                        <!-- PASSO 2 -->
                        <div class="form-step" data-step="2" id="a-step-2" style="display:none;">
                            <h2 class="section-title" style="font-size: 24px; margin-bottom: 16px;">
                                Dados da compra online
                            </h2>

                            <label class="label">Loja / site onde comprou
                                <span class="required-star">*</span>
                            </label>
                            <input class="input" id="a_loja" placeholder="Ex.: Loja X, Site Y" />

                            <label class="label">Produto ou servi√ßo
                                <span class="required-star">*</span>
                            </label>
                            <input class="input" id="a_produto_servico"
                                placeholder="Ex.: Celular modelo X, curso online Y, assinatura Z" />

                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:20px;">
                                <div>
                                    <label class="label">Data da compra
                                        <span class="required-star">*</span>
                                    </label>
                                    <input class="input" id="a_data_compra" placeholder="DD/MM/AAAA" inputmode="numeric"
                                        maxlength="10" />
                                    <div id="a_err_data_compra" class="small"
                                        style="display:none;color:#fca5a5;margin-top:4px;">Data inv√°lida.</div>
                                </div>
                                <div>
                                    <label class="label">Data da entrega (se j√° recebeu, opcional)</label>
                                    <input class="input" id="a_data_entrega" placeholder="DD/MM/AAAA"
                                        inputmode="numeric" maxlength="10" />
                                    <div id="a_err_data_entrega" class="small"
                                        style="display:none;color:#fca5a5;margin-top:4px;">Data inv√°lida.</div>
                                </div>
                            </div>

                            <label class="label" style="margin-top:16px;">Valor pago
                                <span class="required-star">*</span>
                            </label>
                            <input class="input" id="a_valor" placeholder="Ex.: R$ 499,90" />

                            <label class="label">Como a compra foi feita?
                                <span class="required-star">*</span>
                            </label>
                            <select class="input" id="a_meio_compra">
                                <option value="Site (internet)">Site (internet)</option>
                                <option value="Aplicativo (app)">Aplicativo (app)</option>
                                <option value="Telefone">Telefone</option>
                                <option value="Cat√°logo/Casa a Casa">Cat√°logo/Casa a Casa</option>
                                <option value="Outro meio n√£o presencial">Outro meio n√£o presencial</option>
                            </select>

                            <label class="label">Forma de pagamento (opcional)</label>
                            <select class="input" id="a_forma_pagamento">
                                <option value="">Selecione...</option>
                                <option value="Cart√£o de cr√©dito">Cart√£o de cr√©dito</option>
                                <option value="Pix">Pix</option>
                                <option value="Boleto">Boleto</option>
                                <option value="D√©bito em conta">D√©bito em conta</option>
                                <option value="Outro">Outro</option>
                            </select>

                            <div class="form-navigation">
                                <button type="button" class="btn btn-secondary" id="a_prevStep2">
                                    Voltar
                                </button>
                                <button type="button" class="btn btn-primary" id="a_nextStep2">
                                    Pr√≥ximo passo
                                </button>
                            </div>
                        </div>

                        <!-- PASSO 3 -->
                        <div class="form-step" data-step="3" id="a-step-3" style="display:none;">
                            <h2 class="section-title" style="font-size: 24px; margin-bottom: 16px;">
                                Motivo do arrependimento e contato
                            </h2>

                            <label class="label">Qual a situa√ß√£o?
                                <span class="required-star">*</span>
                            </label>
                            <select class="input" id="a_motivo_padrao">
                                <option
                                    value="Estou exercendo meu direito de arrependimento previsto no art. 49 do CDC, dentro do prazo de 7 dias.">
                                    Apenas desejo exercer meu direito de arrependimento (art. 49 CDC).
                                </option>
                                <option value="O produto/servi√ßo n√£o atendeu √†s minhas expectativas.">
                                    O produto/servi√ßo n√£o atendeu √†s minhas expectativas.
                                </option>
                                <option value="O produto √© diferente do anunciado na oferta.">
                                    O produto √© diferente do anunciado.
                                </option>
                                <option value="Houve atraso significativo na entrega e n√£o tenho mais interesse.">
                                    Houve atraso na entrega e n√£o tenho mais interesse.
                                </option>
                                <option value="Outro motivo.">
                                    Outro motivo.
                                </option>
                            </select>

                            <label class="label">Explique com suas palavras (opcional, mas recomendado)</label>
                            <textarea class="input" id="a_motivo_detalhe" rows="4"
                                placeholder="Ex.: O tamanho/modelo n√£o serviu; o servi√ßo n√£o era o que eu imaginava; houve v√°rios problemas na entrega; etc."></textarea>

                            <label class="label" style="margin-top:16px;">Voc√™ j√° tentou contato com a empresa?
                                (opcional)</label>
                            <input class="input" id="a_data_contato"
                                placeholder="Se j√° falou com a empresa, informe a data ou protocolo (opcional)" />

                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:20px;">
                                <div>
                                    <label class="label">E-mail (opcional)</label>
                                    <input class="input" id="a_email" placeholder="seu@email.com" />
                                </div>
                                <div>
                                    <label class="label">Telefone (opcional)</label>
                                    <input class="input" id="a_telefone" placeholder="(00) 00000-0000" />
                                </div>
                            </div>

                            <p class="small" style="margin-top:12px;">
                                O e-mail e telefone s√£o opcionais e usados apenas para envio do documento e, se
                                necess√°rio, contato de suporte.
                            </p>

                            <div class="form-navigation">
                                <button type="button" class="btn btn-secondary" id="a_prevStep3">
                                    Voltar
                                </button>
                                <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:flex-end;">
                                    <button class="btn btn-secondary" id="a_btnPreview">
                                        Gerar pr√©via gratuita
                                    </button>
                                </div>
                            </div>
                            <p class="small" style="margin-top:8px;color:var(--text-muted);">
                                Voc√™ ver√° um trecho do documento antes de decidir pagar. A pr√©via √© gratuita.
                            </p>

                            <div id="a_paySection"
                                style="display:none; margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border);">
                                <div class="price-badge" style="margin-bottom: 20px;">
                                    Oferta hoje: <span class="price-old">de R$ 29,90</span> <span class="price-new">por
                                        R$ 9,90</span>
                                    <span class="timer-text">‚ö° O pre√ßo pode voltar ao normal em breve</span>
                                </div>

                                <button class="btn btn-primary" id="a_btnPagar" style="width: 100%;">
                                    Gerar documento completo (R$ 9,90)
                                </button>

                                <div class="guarantee-badge">
                                    <span class="guarantee-icon">üîí</span>
                                    <div>
                                        <strong>Garantia Total:</strong> Receba seu documento pronto imediatamente ou
                                        devolvemos seu dinheiro em caso de falha do sistema.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PR√âVIA -->
                    <div id="a_previewWrap"
                        style="display:none; margin-top:32px; padding-top:32px; border-top:1px solid var(--border);">
                        <h2 class="section-title" style="font-size: 24px; margin-bottom: 20px;">Pr√©via do documento
                        </h2>
                        <div
                            style="background:var(--bg-secondary);border:1px solid var(--border);border-radius:12px;padding:24px;">
                            <div id="a_previewBox"
                                style="white-space:pre-wrap;font-family:monospace;font-size:14px;line-height:1.8;color:var(--text-secondary);">
                            </div>
                        </div>
                        <p class="small" style="margin-top:12px;color:var(--text-muted);">
                            Pr√©via gratuita e parcial. O documento completo (edi√ß√£o, PDF e Word) √© liberado ap√≥s o
                            pagamento √∫nico de <strong>R$ 9,90</strong>.
                        </p>
                    </div>

                    <!-- Depoimentos + FAQ -->
                    <div style="margin-top:32px;border-top:1px solid var(--border);padding-top:24px;">
                        <h2 class="section-title" style="font-size: 22px; margin-bottom: 16px;">
                            Depoimentos
                        </h2>
                        <div class="small" style="margin-bottom:12px;">
                            ‚ÄúComprei um produto pela internet e me arrependi. A loja enrolava para cancelar. Usei a
                            carta
                            para formalizar e conseguir o estorno.‚Äù<br>
                            <strong>Fernanda, 27 anos ‚Äì S√£o Paulo/SP</strong>
                        </div>
                        <div class="small" style="margin-bottom:20px;">
                            ‚ÄúN√£o sabia como escrever citando o direito de arrependimento. O modelo ajudou muito, foi s√≥
                            preencher meus dados.‚Äù<br>
                            <strong>Lucas, 31 anos ‚Äì Goi√¢nia/GO</strong>
                        </div>

                        <h2 class="section-title" style="font-size: 22px; margin-bottom: 12px;">
                            Perguntas r√°pidas
                        </h2>
                        <p class="small">
                            <strong>O direito de arrependimento vale para qualquer compra?</strong><br>
                            Ele vale para compras <strong>fora do estabelecimento comercial</strong> (internet,
                            telefone, cat√°logo etc.), em at√© <strong>7 dias</strong>, mesmo que o produto n√£o tenha
                            defeito.
                        </p>
                        <p class="small" style="margin-top:8px;">
                            <strong>Posso usar se j√° passou de 7 dias?</strong><br>
                            A carta √© focada no exerc√≠cio do direito de arrependimento do art. 49 (7 dias). Se j√° passou
                            o prazo, pode haver outros direitos (defeito, v√≠cio, propaganda enganosa), mas o caso √© mais
                            complexo.
                        </p>
                        <p class="small" style="margin-top:8px;">
                            <strong>√â pagamento √∫nico?</strong><br>
                            Sim, <strong>R$ 9,90 por documento</strong>, sem assinatura ou mensalidades.
                        </p>
                        <p class="small" style="margin-top:8px;">
                            <strong>Quer entender melhor como funciona o direito de arrependimento?</strong><br>
                            Veja o guia completo sobre
                            <a href="/arrependimento-compra-online-faq.html">arrependimento de compra online e
                                reembolso</a>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>
                    Este site n√£o presta aconselhamento jur√≠dico. Leia os
                    <a href="/termos.html" class="footer-link">Termos de Uso</a>,
                    <a href="/privacidade.html" class="footer-link">Pol√≠tica de Privacidade</a>,
                    conhe√ßa mais em
                    <a href="/sobre.html" class="footer-link">Sobre o CartasApp</a>
                    e visite nossa
                    <a href="/blog.html" class="footer-link">Central de Ajuda</a>.
                </p>
            </div>
        </div>
    </footer>

    <a href="https://wa.me/5547988616874?text=Ol%C3%A1!%20Preciso%20de%20ajuda%20no%20CartasApp." class="whatsapp-float"
        target="_blank" aria-label="Falar no WhatsApp">
        <svg viewBox="0 0 24 24" class="whatsapp-icon">
            <path
                d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
        </svg>
    </a>

    <script src="/utm.js"></script>
    <script src="/recovery.js"></script>

    <script>
        function a_maskCPF(v) { v = (v || '').replace(/\D/g, '').slice(0, 11); v = v.replace(/(\d{3})(\d)/, '$1.$2'); v = v.replace(/(\d{3})(\d)/, '$1.$2'); v = v.replace(/(\d{3})(\d{1,2})$/, '$1-$2'); return v; }
        function a_isValidCPF(cpf) { var s = (cpf || '').replace(/\D/g, ''); if (s.length !== 11) return false; if (/^(\d)\1{10}$/.test(s)) return false; var i, sum = 0, rest; for (i = 1; i <= 9; i++) sum += parseInt(s.substring(i - 1, i)) * (11 - i); rest = (sum * 10) % 11; if (rest === 10 || rest === 11) rest = 0; if (rest !== parseInt(s.substring(9, 10))) return false; sum = 0; for (i = 1; i <= 10; i++) sum += parseInt(s.substring(i - 1, i)) * (12 - i); rest = (sum * 10) % 11; if (rest === 10 || rest === 11) rest = 0; if (rest !== parseInt(s.substring(10, 11))) return false; return true; }
        function a_maskDate(v) { v = (v || '').replace(/\D/g, '').slice(0, 8); if (v.length >= 5) v = v.replace(/(\d{2})(\d{2})(\d{1,4})/, '$1/$2/$3'); else if (v.length >= 3) v = v.replace(/(\d{2})(\d{1,2})/, '$1/$2'); return v; }
        function a_isValidDateBR(s) { if (!/^\d{2}\/\d{2}\/\d{4}$/.test(s || '')) return false; var d = parseInt(s.substr(0, 2), 10), m = parseInt(s.substr(3, 2), 10), y = parseInt(s.substr(6, 4), 10); if (y < 1900 || y > 2100 || m < 1 || m > 12 || d < 1 || d > 31) return false; var md = [31, (y % 4 === 0 && y % 100 !== 0) || y % 400 === 0 ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; if (d > md[m - 1]) return false; return true; }

        var a_cpfInput = document.getElementById('a_cpf');
        if (a_cpfInput) { a_cpfInput.addEventListener('input', function () { this.value = a_maskCPF(this.value); }); }

        var a_dateCompra = document.getElementById('a_data_compra');
        if (a_dateCompra) { a_dateCompra.addEventListener('input', function (ev) { ev.target.value = a_maskDate(ev.target.value); }); }
        var a_dateEntrega = document.getElementById('a_data_entrega');
        if (a_dateEntrega) { a_dateEntrega.addEventListener('input', function (ev) { ev.target.value = a_maskDate(ev.target.value); }); }

        var a_ids = ['a_nome', 'a_cpf', 'a_endereco', 'a_cidade_uf', 'a_loja', 'a_produto_servico', 'a_data_compra', 'a_data_entrega', 'a_valor', 'a_meio_compra', 'a_forma_pagamento', 'a_motivo_padrao', 'a_motivo_detalhe', 'a_data_contato', 'a_email', 'a_telefone'];
        var A_SAVE_KEY = 'arrependimento_compra_online_form_v1';

        function a_saveForm() {
            var o = {};
            for (var i = 0; i < a_ids.length; i++) {
                var el = document.getElementById(a_ids[i]);
                if (!el) continue;
                o[a_ids[i]] = el.value;
            }
            localStorage.setItem(A_SAVE_KEY, JSON.stringify(o));
        }
        function a_loadForm() {
            try {
                var o = JSON.parse(localStorage.getItem(A_SAVE_KEY) || '{}');
                for (var k in o) {
                    var el = document.getElementById(k);
                    if (!el) continue;
                    el.value = o[k];
                }
            } catch (e) { }
        }
        function a_attachAutosave() {
            for (var i = 0; i < a_ids.length; i++) {
                var el = document.getElementById(a_ids[i]);
                if (!el) continue;
                el.addEventListener('input', a_saveForm);
                el.addEventListener('change', a_saveForm);
            }
        }

        function a_getPayload() {
            if (a_cpfInput) a_cpfInput.value = a_maskCPF(a_cpfInput.value);

            var motivoBase = document.getElementById('a_motivo_padrao').value || '';
            var detalhe = document.getElementById('a_motivo_detalhe').value.trim();
            var motivoFinal = motivoBase;
            if (detalhe) motivoFinal += ' ' + detalhe;

            return {
                slug: 'carta-direito-arrependimento-compra-online',
                tipo: 'arrependimento',
                entidade: 'Ecommerce',
                nome: document.getElementById('a_nome').value.trim(),
                cpf: document.getElementById('a_cpf').value.trim(),
                endereco: document.getElementById('a_endereco').value.trim(),
                cidade_uf: document.getElementById('a_cidade_uf').value.trim(),
                loja: document.getElementById('a_loja').value.trim(),
                produto_servico: document.getElementById('a_produto_servico').value.trim(),
                data_compra: document.getElementById('a_data_compra').value.trim(),
                data_entrega: document.getElementById('a_data_entrega').value.trim(),
                valor: document.getElementById('a_valor').value.trim(),
                meio_compra: document.getElementById('a_meio_compra').value,
                forma_pagamento: document.getElementById('a_forma_pagamento').value,
                data_contato: document.getElementById('a_data_contato').value.trim(),
                motivo: motivoFinal.trim(),
                email: document.getElementById('a_email').value.trim(),
                telefone: document.getElementById('a_telefone').value.trim(),
                observacoes: '',
                utm: (window.LMUTM ? LMUTM.get() : {})
            };
        }

        function a_validateAll(p) {
            var ok = true;
            function show(id, showFlag) { var el = document.getElementById(id); if (el) el.style.display = showFlag ? 'block' : 'none'; }

            if (!p.nome || !p.cpf || !p.endereco || !p.cidade_uf ||
                !p.loja || !p.produto_servico || !p.data_compra || !p.valor || !p.meio_compra) {
                ok = false;
            }

            if (p.cpf && !a_isValidCPF(p.cpf)) { show('a_err_cpf', true); ok = false; } else show('a_err_cpf', false);

            if (!a_isValidDateBR(p.data_compra)) { show('a_err_data_compra', true); ok = false; } else show('a_err_data_compra', false);

            if (p.data_entrega) {
                if (!a_isValidDateBR(p.data_entrega)) { show('a_err_data_entrega', true); ok = false; } else show('a_err_data_entrega', false);
            } else {
                show('a_err_data_entrega', false);
            }

            if (!p.motivo) ok = false;

            return ok;
        }

        var a_currentStep = 1;
        function a_showStep(step) {
            a_currentStep = step;
            var steps = document.querySelectorAll('.form-step');
            steps.forEach(function (s) {
                var n = parseInt(s.getAttribute('data-step'), 10);
                s.style.display = (n === step) ? 'block' : 'none';
            });
            var items = document.querySelectorAll('.step-item');
            items.forEach(function (it) {
                var n = parseInt(it.getAttribute('data-step'), 10);
                it.classList.toggle('active', n === step);
                it.classList.toggle('completed', n < step);
            });
        }

        function a_validateStep(step) {
            var p = a_getPayload();
            var msg = '';

            if (step === 1) {
                if (!p.nome || !p.cpf || !p.endereco || !p.cidade_uf) {
                    msg = 'Preencha nome, CPF, endere√ßo e cidade/UF.';
                } else if (!a_isValidCPF(p.cpf)) {
                    msg = 'CPF inv√°lido.';
                }
            } else if (step === 2) {
                if (!p.loja || !p.produto_servico || !p.data_compra || !p.valor || !p.meio_compra) {
                    msg = 'Preencha loja, produto, data da compra, valor e meio da compra.';
                } else if (!a_isValidDateBR(p.data_compra)) {
                    msg = 'Data da compra inv√°lida.';
                }
            } else if (step === 3) {
                if (!p.motivo) {
                    msg = 'Selecione uma situa√ß√£o e, se poss√≠vel, explique com suas palavras.';
                }
            }

            if (msg) {
                alert(msg);
                return false;
            }
            return true;
        }

        var a_nextStep1 = document.getElementById('a_nextStep1');
        if (a_nextStep1) a_nextStep1.addEventListener('click', function () {
            if (a_validateStep(1)) a_showStep(2);
        });

        var a_nextStep2 = document.getElementById('a_nextStep2');
        if (a_nextStep2) a_nextStep2.addEventListener('click', function () {
            if (a_validateStep(2)) a_showStep(3);
        });

        var a_prevStep2 = document.getElementById('a_prevStep2');
        if (a_prevStep2) a_prevStep2.addEventListener('click', function () {
            a_showStep(1);
        });

        var a_prevStep3 = document.getElementById('a_prevStep3');
        if (a_prevStep3) a_prevStep3.addEventListener('click', function () {
            a_showStep(2);
        });

        var a_btnPreview = document.getElementById('a_btnPreview');
        var a_btnPagar = document.getElementById('a_btnPagar');
        var a_previewWrap = document.getElementById('a_previewWrap');
        var a_previewBox = document.getElementById('a_previewBox');
        var a_paySection = document.getElementById('a_paySection');

        a_loadForm();
        a_attachAutosave();
        a_showStep(1);

        function a_captureLead(p) {
            fetch('/.netlify/functions/capture-lead', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: p.email,
                    telefone: p.telefone,
                    nome: p.nome,
                    slug: 'carta-direito-arrependimento-compra-online',
                    payload: p
                })
            }).catch(err => console.log('Lead capture bg error', err));
        }

        function a_checkCooldown() {
            var last = localStorage.getItem('last_preview_ts_arrependimento');
            if (last && (Date.now() - parseInt(last)) < 30000) {
                alert('Por favor, aguarde alguns segundos antes de gerar outra pr√©via.');
                return false;
            }
            return true;
        }

        a_btnPreview.addEventListener('click', function () {
            if (!a_checkCooldown()) return;

            a_btnPreview.disabled = true;
            a_btnPreview.style.opacity = '0.5';
            a_btnPreview.style.cursor = 'not-allowed';
            a_btnPreview.textContent = '‚è≥ Gerando pr√©via...';

            async function tentarGerar(tentativa) {
                var vaiTentarDeNovo = false;
                try {
                    var payload = a_getPayload();
                    if (!a_validateAll(payload)) {
                        alert('Verifique os campos obrigat√≥rios (destacados em vermelho).');
                        a_btnPreview.disabled = false;
                        a_btnPreview.style.opacity = '1';
                        a_btnPreview.style.cursor = 'pointer';
                        a_btnPreview.textContent = 'Gerar pr√©via gratuita';
                        return;
                    }

                    a_saveForm();

                    if (tentativa === 1 && (payload.email || payload.telefone)) {
                        a_captureLead(payload);
                    }

                    var r = await fetch('/.netlify/functions/generate-doc', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ payload: payload, preview: true })
                    });

                    if (r.status === 503 && tentativa === 1) {
                        console.log('Servidor ocupado (503), tentando novamente...');
                        a_btnPreview.textContent = '‚Üª Reconectando...';
                        vaiTentarDeNovo = true;
                        await new Promise(res => setTimeout(res, 2000));
                        return tentarGerar(2);
                    }

                    if (!r.ok) {
                        var errText = 'Falha ao gerar';
                        try { var errData = await r.json(); if (errData.body) errText = errData.body; } catch (e) { }
                        throw new Error(errText);
                    }

                    var data = await r.json();
                    var out = data.output || data;
                    var pars = out.corpo_paragrafos || [];
                    var keep = Math.max(1, Math.min(2, pars.length));
                    var parcialText = pars.slice(0, keep).join('\n\n') + '\n\n[...]';
                    var saud = out.saudacao || '';
                    var checklist = out.check_list_anexos || [];
                    var chkShow = checklist.slice(0, 2);
                    if (checklist.length > 2) chkShow.push('...');
                    var finalPreview = (saud ? saud + '\n\n' : '') + parcialText + '\n\nChecklist de anexos (parcial): ' + chkShow.join('; ');

                    a_previewBox.textContent = finalPreview;
                    a_previewWrap.style.display = 'block';
                    a_paySection.style.display = 'block';
                    a_btnPreview.style.display = 'none';

                    if (typeof gtag === 'function') {
                        gtag('event', 'generate_lead', {
                            'send_to': 'AW-1021062139/Ri4bCICS88IbEPvX8OYD',
                            'event_category': 'engagement',
                            'event_label': 'arrependimento_compra_online',
                            'value': 2.00,
                            'currency': 'BRL'
                        });
                    }

                    localStorage.setItem('pendingPayload', JSON.stringify(payload));
                    localStorage.setItem('last_preview_ts_arrependimento', Date.now());
                    a_btnPagar.disabled = false;

                } catch (e) {
                    if (!vaiTentarDeNovo) {
                        if (e.message !== 'Campos inv√°lidos') { alert('Erro ao gerar: ' + e.message); }
                        a_btnPreview.disabled = false;
                        a_btnPreview.style.opacity = '1';
                        a_btnPreview.style.cursor = 'pointer';
                        a_btnPreview.textContent = 'Gerar pr√©via gratuita';
                    }
                }
            }

            tentarGerar(1);
        });

        a_btnPagar.addEventListener('click', async function () {
            a_btnPagar.disabled = true; a_btnPagar.textContent = 'Preparando...';
            try {
                var payload = a_getPayload();
                if (!a_validateAll(payload)) {
                    alert('Preencha os campos obrigat√≥rios.');
                    throw new Error('Campos inv√°lidos');
                }

                a_saveForm();
                localStorage.setItem('pendingPayload', JSON.stringify(payload));
                var slugStr = 'carta-direito-arrependimento-compra-online';

                var r = await fetch('/.netlify/functions/mp-checkout', {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ slug: slugStr, payload: payload, utm: (window.LMUTM ? LMUTM.get() : {}) })
                });
                var data = await r.json();
                if (!r.ok) throw new Error(data.error || 'Erro no pagamento');

                localStorage.setItem('lastOrderId', data.order_id || '');
                if (typeof gtag === 'function') {
                    gtag('event', 'begin_checkout', { value: 9.9, currency: 'BRL', items: [{ item_id: slugStr }] });
                }
                a_showPaymentModal(data.init_point, data.order_id, slugStr);
            } catch (e) {
                if (e.message !== 'Campos inv√°lidos') alert('Erro: ' + e.message);
                a_btnPagar.disabled = false; a_btnPagar.textContent = 'Gerar documento completo (R$ 9,90)';
            }
        });

        function a_showPaymentModal(initPoint, orderId, slug) {
            var isLight = (document.documentElement.getAttribute('data-theme') === 'light');
            var cardBG = isLight ? '#ffffff' : '#111827';
            var cardText = isLight ? '#0f172a' : '#e6eefb';

            var overlay = document.createElement('div');
            overlay.style = 'position:fixed;inset:0;background:rgba(2,6,23,.85);backdrop-filter:blur(4px);z-index:9999;display:flex;align-items:center;justify-content:center';

            overlay.innerHTML =
                '<div style="background:' + cardBG + ';color:' + cardText + ';border:1px solid var(--border);border-radius:16px;max-width:400px;width:90%;padding:24px;box-shadow:0 20px 50px rgba(0,0,0,.4);text-align:center;">' +
                '<div style="font-size:40px;margin-bottom:16px;">üí∏</div>' +
                '<h3 style="margin:0 0 12px;font-size:20px;">Quase l√°!</h3>' +
                '<p style="margin:0 0 20px;line-height:1.5;color:var(--text-secondary);">Clique no bot√£o abaixo para finalizar o pagamento com seguran√ßa no Mercado Pago.</p>' +

                '<div style="display:flex;flex-direction:column;gap:12px;">' +
                '<button id="a-lm-goPay" class="btn btn-primary" style="width:100%;padding:14px;font-size:16px;justify-content:center;">Ir para Pagamento (Pix ou Cart√£o)</button>' +
                '<button id="a-lm-close" class="btn btn-outline" style="width:100%;justify-content:center;border:none;">Fechar e corrigir dados</button>' +
                '</div>' +

                '<p id="a-lm-statusPay" class="small" style="margin-top:16px;font-size:12px;opacity:0.8;"></p>' +
                '</div>';

            document.body.appendChild(overlay);

            document.getElementById('a-lm-close').onclick = function () {
                overlay.remove();
                var btnPagar = document.getElementById('a_btnPagar');
                if (btnPagar) {
                    btnPagar.disabled = false;
                    btnPagar.textContent = 'Gerar documento completo (R$ 9,90)';
                }
            };

            async function docReady() {
                try {
                    var r = await fetch('/.netlify/functions/generate-doc', {
                        method: 'POST', headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ payload: { order_id: orderId }, preview: false })
                    });
                    if (!r.ok) return false;
                    var j = await r.json();
                    return !!(j && j.output);
                } catch (e) { return false; }
            }

            document.getElementById('a-lm-goPay').onclick = function () {
                window.open(initPoint, '_blank', 'noopener');

                var btn = this;
                btn.textContent = 'Verificando pagamento...';
                document.getElementById('a-lm-statusPay').textContent = 'Aguarde, estamos confirmando seu pagamento...';

                var iv = setInterval(async function () {
                    try {
                        if (await docReady()) {
                            clearInterval(iv);
                            location.href = '/success.html?o=' + encodeURIComponent(orderId) + '&slug=' + encodeURIComponent(slug) + '&s=success';
                            return;
                        }
                        var rr = await fetch('/.netlify/functions/order-status?o=' + encodeURIComponent(orderId));
                        var jj = rr.ok ? await rr.json() : null;
                        if (jj && jj.status === 'paid') {
                            clearInterval(iv);
                            location.href = '/success.html?o=' + encodeURIComponent(orderId) + '&slug=' + encodeURIComponent(slug) + '&s=success';
                        }
                    } catch (e) { }
                }, 3000);
            };
        }
    </script>

    <!-- Bot√£o Admin (?modo=admin) -->
    <script>
        (function () {
            const params = new URLSearchParams(window.location.search);
            if (params.get('modo') === 'admin') {
                const btnPagar = document.querySelector('[id*="Pagar"], [id*="pagar"]') || document.getElementById('a_btnPagar');
                if (!btnPagar) return;

                const btnArea = btnPagar.parentElement;

                const btnAdmin = document.createElement('button');
                btnAdmin.className = 'btn';
                btnAdmin.style.backgroundColor = '#8b5cf6';
                btnAdmin.style.color = 'white';
                btnAdmin.style.border = 'none';
                btnAdmin.innerText = 'üëë Gerar Admin';

                btnAdmin.onclick = async function () {
                    const senha = prompt("Digite a senha de Admin:");
                    if (!senha) return;

                    btnAdmin.innerText = 'Gerando...';
                    btnAdmin.disabled = true;

                    try {
                        var p = a_getPayload();
                        p.admin_key = senha;

                        var r = await fetch('/.netlify/functions/generate-doc', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ payload: p, preview: false })
                        });

                        if (!r.ok) throw new Error('Senha errada ou erro no servidor');

                        var data = await r.json();

                        if (data.output) {
                            let fullText = '';
                            if (data.output.saudacao) fullText += data.output.saudacao + '\n\n';
                            if (Array.isArray(data.output.corpo_paragrafos)) {
                                fullText += data.output.corpo_paragrafos.join('\n\n');
                            } else {
                                fullText += String(data.output.corpo_paragrafos);
                            }
                            if (data.output.fechamento) fullText += '\n\n' + data.output.fechamento;

                            const previewBox = document.getElementById('a_previewBox');
                            const previewWrap = document.getElementById('a_previewWrap');

                            if (previewBox && previewWrap) {
                                previewBox.textContent = fullText;
                                previewBox.style.whiteSpace = 'pre-wrap';
                                previewWrap.style.display = 'block';

                                const oldCopyBtn = document.getElementById('a-admin-copy-btn');
                                if (oldCopyBtn) oldCopyBtn.remove();

                                const copyBtn = document.createElement('button');
                                copyBtn.id = 'a-admin-copy-btn';
                                copyBtn.className = 'btn btn-primary';
                                copyBtn.style.marginTop = '16px';
                                copyBtn.innerText = 'üìã Copiar Documento';
                                copyBtn.onclick = async function () {
                                    await navigator.clipboard.writeText(fullText);
                                    copyBtn.innerText = '‚úÖ Copiado!';
                                    setTimeout(() => { copyBtn.innerText = 'üìã Copiar Documento'; }, 2000);
                                };
                                previewWrap.appendChild(copyBtn);

                                previewWrap.scrollIntoView({ behavior: 'smooth', block: 'start' });
                                alert("‚úÖ Documento Admin Gerado!\n\nRole para baixo para copiar.");
                            } else {
                                alert("‚úÖ Documento Gerado!\n\n" + fullText.substring(0, 500) + "...\n\n(Copie do console)");
                                console.log(fullText);
                            }
                        }

                    } catch (e) {
                        alert('‚ùå Erro: ' + e.message);
                    } finally {
                        btnAdmin.innerText = 'üëë Gerar Admin';
                        btnAdmin.disabled = false;
                    }
                };

                btnArea.appendChild(btnAdmin);
            }
        })();
    </script>
</body>

</html>
